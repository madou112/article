import{_ as J,u as K,j as v,r,o as f,c as k,d as t,w as o,b as a,f as s,F as N,h as $,i as B,p as Q,g as R}from"./index-0fd3abc3.js";import{a as W,b as X,c as Y,d as Z,e as ee}from"./article-56aaecd4.js";import{d as le,a as te}from"./article-cat-936f24bd.js";const c=b=>(Q("data-v-527dda08"),b=b(),R(),b),ae={class:"card-header"},oe=c(()=>a("span",null,"文章管理",-1)),ne=c(()=>a("br",null,null,-1)),de=c(()=>a("br",null,null,-1)),ue=c(()=>a("br",null,null,-1)),ie=c(()=>a("br",null,null,-1)),re=c(()=>a("br",null,null,-1)),se=c(()=>a("br",null,null,-1)),pe=c(()=>a("br",null,null,-1)),ce=c(()=>a("br",null,null,-1)),ve=c(()=>a("br",null,null,-1)),me={__name:"articleMgr",setup(b){K();const g=v(!1),V=v(!1),z=v([]),w=v([]),u=v({articleCatId:"",content:"",createTime:"",deleted:0,id:0,open:0,title:"",updateTime:"",userinfoId:0}),d=v(),C=v(1),I=v(5),U=v(0),A=()=>{u.value={articleCatId:"",content:"",open:"",title:"",userinfoId:0},g.value=!0},E=()=>{let n={articleCatId:parseInt(u.value.articleCatId),content:u.value.content,createTime:new Date,deleted:0,id:0,open:parseInt(u.value.open),title:u.value.title,updateTime:new Date,userinfoId:0};X(n).then(e=>{e.data.code==1&&(alert("文章新增成功。"),g.value=!1,m())})},M=n=>{Y(n).then(e=>{d.value=e.data.data.article,V.value=!0})},P=()=>{let n={articleCatId:parseInt(d.value.articleCatId),content:d.value.content,createTime:d.value.createTime,deleted:d.value.deleted,id:d.value.id,open:parseInt(d.value.open),title:d.value.title,updateTime:new Date,userinfoId:d.value.userinfoId};Z(n).then(e=>{e.data.code==1&&(alert("修改成功。"),V.value=!1,m())})},j=n=>{confirm("是否要删除该文章？")&&ee(n).then(e=>{e.data.code==1&&(alert("该文章删除成功。"),m())})},m=()=>{let n={current:C.value,size:I.value};W(n).then(e=>{let p=e.data.data.pages.records;U.value=e.data.data.pages.total,Promise.all(p.map(i=>le(i.articleCatId))).then(i=>{for(let _=0;_<p.length;_++)p[_].articleCatId=i[_].data.data.articleCat.catName;z.value=p})})},F=()=>{te().then(n=>{w.value=n.data.data.articleCats})},L=n=>{I.value=n,m()},O=n=>{C.value=n,m()};return m(),F(),(n,e)=>{const p=r("el-button"),i=r("el-table-column"),_=r("el-table"),q=r("el-pagination"),G=r("el-card"),D=r("el-option"),x=r("el-select"),y=r("el-input"),h=r("el-radio"),S=r("el-radio-group"),T=r("el-dialog");return f(),k("div",null,[t(G,{class:"box-card"},{header:o(()=>[a("div",ae,[oe,t(p,{type:"primary",onClick:e[0]||(e[0]=l=>A())},{default:o(()=>[s("新增")]),_:1})])]),default:o(()=>[a("div",null,[t(_,{data:z.value,style:{width:"100%"}},{default:o(()=>[t(i,{prop:"id",label:"ID"}),t(i,{prop:"articleCatId",label:"知识库分类"}),t(i,{prop:"title",label:"文章标题"}),t(i,{prop:"content",label:"文章内容",width:"500"}),t(i,{prop:"userinfoId",label:"用户信息ID"}),t(i,{prop:"open",label:"open"}),t(i,{fixed:"right",label:"操作"},{default:o(l=>[t(p,{link:"",type:"primary",size:"small",onClick:H=>M(l.row.id)},{default:o(()=>[s("编辑")]),_:2},1032,["onClick"]),t(p,{link:"",type:"danger",size:"small",onClick:H=>j(l.row.id)},{default:o(()=>[s("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),ne,a("div",null,[t(q,{"current-page":C.value,"onUpdate:currentPage":e[1]||(e[1]=l=>C.value=l),"page-size":I.value,"onUpdate:pageSize":e[2]||(e[2]=l=>I.value=l),"page-sizes":[5,10,15,20],small:n.small,background:n.background,layout:"total, sizes, prev, pager, next, jumper",total:U.value,onSizeChange:L,onCurrentChange:O},null,8,["current-page","page-size","small","background","total"])])]),_:1}),t(T,{modelValue:g.value,"onUpdate:modelValue":e[8]||(e[8]=l=>g.value=l),title:"新增文章",style:{width:"40%"}},{default:o(()=>[a("div",null,[a("div",null,[t(x,{modelValue:u.value.articleCatId,"onUpdate:modelValue":e[3]||(e[3]=l=>u.value.articleCatId=l),placeholder:"知识库分类",size:"large",style:{width:"100%"}},{default:o(()=>[(f(!0),k(N,null,$(w.value,l=>(f(),B(D,{key:l.id,label:l.catName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),de,a("div",null,[t(y,{modelValue:u.value.title,"onUpdate:modelValue":e[4]||(e[4]=l=>u.value.title=l),placeholder:"文章标题"},null,8,["modelValue"])]),ue,a("div",null,[t(y,{modelValue:u.value.content,"onUpdate:modelValue":e[5]||(e[5]=l=>u.value.content=l),placeholder:"文章内容",type:"textarea"},null,8,["modelValue"])]),ie,a("div",null,[s(" 是否显示： "),t(S,{modelValue:u.value.open,"onUpdate:modelValue":e[6]||(e[6]=l=>u.value.open=l),size:"small"},{default:o(()=>[t(h,{label:1,border:""},{default:o(()=>[s("true")]),_:1}),t(h,{label:0,border:""},{default:o(()=>[s("false")]),_:1})]),_:1},8,["modelValue"])]),re,a("div",null,[t(p,{type:"primary",style:{width:"100%"},onClick:e[7]||(e[7]=l=>E())},{default:o(()=>[s("添加")]),_:1})])])]),_:1},8,["modelValue"]),t(T,{modelValue:V.value,"onUpdate:modelValue":e[14]||(e[14]=l=>V.value=l),title:"修改文章",style:{width:"40%"}},{default:o(()=>[a("div",null,[a("div",null,[t(x,{modelValue:d.value.articleCatId,"onUpdate:modelValue":e[9]||(e[9]=l=>d.value.articleCatId=l),placeholder:"知识库分类",size:"large",style:{width:"100%"}},{default:o(()=>[(f(!0),k(N,null,$(w.value,l=>(f(),B(D,{key:l.id,label:l.catName,value:l.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),se,a("div",null,[t(y,{modelValue:d.value.title,"onUpdate:modelValue":e[10]||(e[10]=l=>d.value.title=l),placeholder:"文章标题"},null,8,["modelValue"])]),pe,a("div",null,[t(y,{modelValue:d.value.content,"onUpdate:modelValue":e[11]||(e[11]=l=>d.value.content=l),placeholder:"文章内容",type:"textarea"},null,8,["modelValue"])]),ce,a("div",null,[s(" 是否显示： "),t(S,{modelValue:d.value.open,"onUpdate:modelValue":e[12]||(e[12]=l=>d.value.open=l),size:"small"},{default:o(()=>[t(h,{label:1,border:""},{default:o(()=>[s("true")]),_:1}),t(h,{label:0,border:""},{default:o(()=>[s("false")]),_:1})]),_:1},8,["modelValue"])]),ve,a("div",null,[t(p,{type:"primary",style:{width:"100%"},onClick:e[13]||(e[13]=l=>P())},{default:o(()=>[s("添加")]),_:1})])])]),_:1},8,["modelValue"])])}}},ge=J(me,[["__scopeId","data-v-527dda08"]]);export{ge as default};
